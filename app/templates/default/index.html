<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caída Libre</title>
    <link rel="icon" href="{{ url_for('static', path='img/favicon.ico') }}" type="image/x-icon">
    <link rel="stylesheet" href="{{ url_for('static', path='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='css/sidebar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='css/gallery.css') }}">
    <style>
        body {
            background-image: url("{{ url_for('static', path='img/bg_pattern.png') }}");
            background-size: 300px 300px;
            background-repeat: repeat;
            background-position: center;
            background-attachment: fixed;
        }
        header {
            height: 100vh;
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url("{{ url_for('static', path='img/bg.jpg') }}") center/cover no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
        }
    </style>
</head>
<body>
    {% include 'components/sidebar.html' %}

    <nav>
        <div class="nav-logo">
            <img src="{{ url_for('static', path='img/logo_white.png') }}" alt="cali">
        </div>
        <ul class="nav-links">
            <li><a href="#inicio">Inicio</a></li>
            <li><a href="#nosotros">Nosotros</a></li>
            <li><a href="#musica">Música</a></li>
            <li><a href="#galeria">Galería</a></li>
            <li><a href="#contacto">Contacto</a></li>
        </ul>
    </nav>

    <header id="inicio">
        <h1 class="logo">
            <img src="{{ url_for('static', path='img/logo_white.png') }}" alt="cali">
        </h1>
        <p class="tagline">La gravedad del rock en cada acorde</p>
    </header>

    <section id="nosotros">
        <h2 class="section-title">Nosotros</h2>
        <div class="about-content">
            <div class="about-text">
                <p>
                    Emergiendo del vibrante panorama musical de la región del Bio-Bio,
                    “Caída Libre” es una banda que ha demostrado ser una fuerza imparable en la escena musical.
                </p>
                <p>
                    Desde su debut ha dejado una huella indeleble en diversos escenarios,
                    acumulando premios y reconocimientos a lo largo de los años. Su música,
                    una mezcla de pasión, talento y creatividad, ha resonado con el público y
                    los críticos por igual.
                </p>
            </div>
        </div>
    </section>

    <section id="musica" class="music">
        <h2 class="section-title">Música</h2>
        <div class="albums">
            <div class="album">
                <div class="album-cover">
                    <img src="{{ url_for('static', path='img/singles/caracol.jpeg') }}" alt="Single Caracol">
                </div>
                <div class="album-info">
                    <h3 class="album-title">Caracol</h3>
                    <p class="album-year">2025</p>
                    <div class="album-links">
                        <a href="#">Spotify</a>
                        <a href="#">Apple&nbsp;Music</a>
                        <a href="#">YouTube</a>
                    </div>
                </div>
            </div>

            <div class="album">
                <div class="album-cover">
                    <img src="{{ url_for('static', path='img/singles/escencia.jpg') }}" alt="Single Escencia">
                </div>
                <div class="album-info">
                    <h3 class="album-title">Escencia</h3>
                    <p class="album-year">2025</p>
                    <div class="album-links">
                        <a href="#">Spotify</a>
                        <a href="#">Apple&nbsp;Music</a>
                        <a href="#">YouTube</a>
                    </div>
                </div>
            </div>

            <div class="album">
                <div class="album-cover">
                    <img src="{{ url_for('static', path='img/covers/vivo.png') }}" alt="Cover Vivo">
                </div>
                <div class="album-info">
                    <h3 class="album-title">Vivo (Cover)</h3>
                    <p class="album-year">2025</p>
                    <div class="album-links">
                        <a href="https://www.youtube.com/watch?v=rUT8LfNcsmQ" target="_blank">YouTube</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="conciertos" style="display: none;">
        <h2 class="section-title">Próximos Conciertos</h2>
        <div class="concerts">
            <div class="concert">
                <p class="concert-date">25 de Marzo, 2025</p>
                <h3 class="concert-venue">Foro Indie Rocks!</h3>
                <p class="concert-location">Ciudad de México, MX</p>
                <a href="#" class="btn">Comprar Boletos</a>
            </div>
            
            <div class="concert">
                <p class="concert-date">12 de Abril, 2025</p>
                <h3 class="concert-venue">C3 Stage</h3>
                <p class="concert-location">Guadalajara, MX</p>
                <a href="#" class="btn">Comprar Boletos</a>
            </div>
            
            <div class="concert">
                <p class="concert-date">30 de Abril, 2025</p>
                <h3 class="concert-venue">Foro Alicia</h3>
                <p class="concert-location">Ciudad de México, MX</p>
                <a href="#" class="btn">Comprar Boletos</a>
            </div>
            
            <div class="concert">
                <p class="concert-date">15 de Mayo, 2025</p>
                <h3 class="concert-venue">Café Iguana</h3>
                <p class="concert-location">Monterrey, MX</p>
                <a href="#" class="btn">Comprar Boletos</a>
            </div>
        </div>
    </section>

    {% include 'components/gallery.html' %}

    <section id="contacto">
        <h2 class="section-title">Contacto</h2>
        <div class="contact-content">
            <div class="contact-form">
                <div class="form-group">
                    <label for="name">Nombre</label>
                    <input type="text" id="name" placeholder="Tu nombre">
                </div>
                <div class="form-group">
                    <label for="email">Correo Electrónico</label>
                    <input type="email" id="email" placeholder="Tu correo">
                </div>
                <div class="form-group">
                    <label for="subject">Asunto</label>
                    <input type="text" id="subject" placeholder="Asunto">
                </div>
                <div class="form-group">
                    <label for="message">Mensaje</label>
                    <textarea id="message" placeholder="Tu mensaje"></textarea>
                </div>
                <a href="#" class="btn">Enviar Mensaje</a>
            </div>

            <div class="contact-info">
                <div class="info-item">
                    <h3>Booking</h3>
                    <p>booking@caidalibre.com</p>
                    <p>+56 9 8660 0933</p>
                </div>
                <div class="info-item">
                    <h3>Dirección</h3>
                    <p>Concepción & Chiguayante</p>
                    <p>Chile</p>
                </div>

                <div class="social-links">
                    <a href="https://www.instagram.com/banda_caidalibre" target="_blank">Instagram</a>
                    <a href="https://www.youtube.com/@banda_caidalibre" target="_blank">YouTube</a>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-logo">Caída Libre</div>
        <ul class="footer-links">
            <li><a href="#inicio">Inicio</a></li>
            <li><a href="#nosotros">Nosotros</a></li>
            <li><a href="#musica">Música</a></li>
            <li><a href="#galeria">Galería</a></li>
            <li><a href="#contacto">Contacto</a></li>
        </ul>
        <p class="copyright">© 2025 Caída Libre. Todos los derechos reservados.</p>
    </footer>

    <script src="{{ url_for('static', path='js/sidebar.js') }}"></script>
    <script>
        // Define gallery data for each event
        const galleryData = {
            'arts_room': [
                {
                    src: "img/gallery/events/arts_room/all.webp",
                    alt: "Todos los integrantes"
                },
                {
                    src: "img/gallery/events/arts_room/agus.webp",
                    alt: "Agustín el guitarrista"
                },
                {
                    src: "img/gallery/events/arts_room/basti.webp",
                    alt: "Bastián el otro guitarrista"
                },
                {
                    src: "img/gallery/events/arts_room/cris.webp",
                    alt: "Cristobal el baterista"
                },
                {
                    src: "img/gallery/events/arts_room/mati.webp",
                    alt: "Matías el bajista y vocalista"
                },
                {
                    src: "img/gallery/events/arts_room/rico.webp",
                    alt: "Sebastián el tecladista"
                }
            ],
            'arts_fest_ubb': [
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4133.webp",
                    alt: "Sebastián y Bastián"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4159.webp",
                    alt: "Sebastián el tecladista"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4174.webp",
                    alt: "Sebastián el tecladista"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4182.webp",
                    alt: "Agustín el guitarrista"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4195.webp",
                    alt: "Cristobal el baterista"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4208.webp",
                    alt: "Bastián el guitarrista"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4255.webp",
                    alt: "El bajo de Matías"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4257.webp",
                    alt: "Sebastián, Bastián y Matías en el escenario"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4277.webp",
                    alt: "Guitarra de Agustín"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4298.webp",
                    alt: "Agustín de perfil"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4312.webp",
                    alt: "Matías cantando"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4330.webp",
                    alt: "Bastián tocando el bajo"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4342.webp",
                    alt: "Bastián tocando el bajo de Matías y Matías cantando"
                },
                {
                    src: "img/gallery/events/arts_fest_ubb/_MG_4353.webp",
                    alt: "Cristobal tocando la batería"
                }
            ]
        };

        document.addEventListener('DOMContentLoaded', function() {
            const lightbox = document.getElementById('gallery-lightbox');
            const lightboxImages = document.querySelector('.lightbox-images');
            const lightboxThumbnails = document.querySelector('.lightbox-thumbnails');
            const lightboxCaption = document.querySelector('.lightbox-caption');
            const closeLightbox = document.querySelector('.close-lightbox');
            const prevBtn = document.querySelector('.prev-btn');
            const nextBtn = document.querySelector('.next-btn');
            
            let currentEvent = '';
            let currentIndex = 0;
            
            // Setup click handlers for all gallery photos
            const photos = document.querySelectorAll('.photo');
            photos.forEach(photo => {
                photo.addEventListener('click', function() {
                    const event = this.getAttribute('data-event');
                    const index = this.getAttribute('data-index') || 0;
                    
                    openLightbox(event, parseInt(index));
                });
            });
            
            // Close lightbox when clicking the X
            closeLightbox.addEventListener('click', function() {
                lightbox.style.display = 'none';
                document.body.style.overflow = 'auto'; // Re-enable scrolling
            });
            
            // Close lightbox when clicking outside the content
            lightbox.addEventListener('click', function(e) {
                if (e.target === lightbox) {
                    lightbox.style.display = 'none';
                    document.body.style.overflow = 'auto'; // Re-enable scrolling
                }
            });
            
            // Previous and next buttons
            prevBtn.addEventListener('click', function() {
                navigateLightbox(-1);
            });
            
            nextBtn.addEventListener('click', function() {
                navigateLightbox(1);
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (lightbox.style.display === 'block') {
                    if (e.key === 'ArrowLeft') {
                        navigateLightbox(-1);
                    } else if (e.key === 'ArrowRight') {
                        navigateLightbox(1);
                    } else if (e.key === 'Escape') {
                        lightbox.style.display = 'none';
                        document.body.style.overflow = 'auto'; // Re-enable scrolling
                    }
                }
            });
            
            function openLightbox(event, index) {
                // Clear previous contents
                lightboxImages.innerHTML = '';
                lightboxThumbnails.innerHTML = '';
                
                currentEvent = event;
                currentIndex = index;
                
                // Add full-size images
                const eventData = galleryData[event];
                eventData.forEach((img, idx) => {
                    const imgElement = document.createElement('img');
                    // Convert relative path to template format for server-side rendering
                    const fullPath = `{{ url_for('static', path='${img.src}') }}`;
                    imgElement.src = fullPath;
                    imgElement.alt = img.alt;
                    imgElement.className = idx === index ? 'active' : '';
                    lightboxImages.appendChild(imgElement);
                    
                    // Create thumbnails
                    const thumbnail = document.createElement('div');
                    thumbnail.className = `lightbox-thumbnail ${idx === index ? 'active' : ''}`;
                    thumbnail.setAttribute('data-index', idx);
                    
                    const thumbImg = document.createElement('img');
                    thumbImg.src = fullPath;
                    thumbImg.alt = img.alt;
                    
                    thumbnail.appendChild(thumbImg);
                    lightboxThumbnails.appendChild(thumbnail);
                    
                    // Thumbnail click handler
                    thumbnail.addEventListener('click', function() {
                        const clickedIndex = parseInt(this.getAttribute('data-index'));
                        setActiveLightboxImage(clickedIndex);
                    });
                });
                
                // Set caption for the current image
                lightboxCaption.textContent = eventData[index].alt;
                
                // Display lightbox
                lightbox.style.display = 'block';
                document.body.style.overflow = 'hidden'; // Prevent scrolling while lightbox is open
            }
            
            function navigateLightbox(direction) {
                const eventData = galleryData[currentEvent];
                let newIndex = currentIndex + direction;
                
                // Handle wrapping around at the ends
                if (newIndex < 0) {
                    newIndex = eventData.length - 1;
                } else if (newIndex >= eventData.length) {
                    newIndex = 0;
                }
                
                setActiveLightboxImage(newIndex);
            }
            
            function setActiveLightboxImage(index) {
                const eventData = galleryData[currentEvent];
                
                // Update current index
                currentIndex = index;
                
                // Update active image
                const images = lightboxImages.querySelectorAll('img');
                images.forEach((img, idx) => {
                    img.className = idx === index ? 'active' : '';
                });
                
                // Update active thumbnail
                const thumbnails = lightboxThumbnails.querySelectorAll('.lightbox-thumbnail');
                thumbnails.forEach((thumb, idx) => {
                    thumb.className = `lightbox-thumbnail ${idx === index ? 'active' : ''}`;
                });

                thumbnails[index].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                
                // Update caption
                lightboxCaption.textContent = eventData[index].alt;
            }
        });
    </script>
</body>
</html>